

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Implementation &mdash; Caravel-Transit 1.1 documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Caravel-Transit 1.1 documentation" href="../index.html" />
    <link rel="prev" title="Route Discovery" href="../design/route_details.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../design/route_details.html" title="Route Discovery"
             accesskey="P">previous</a> |</li>
        <li><a href="../caravel.html">Caravel-Transit 1.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="implementation">
<h1>Implementation<a class="headerlink" href="#implementation" title="Permalink to this headline">¶</a></h1>
<p>This section contains Sphinx &#8220;automodule&#8221; documentation from the various
components.</p>
<p>There are two tiers: <a class="reference internal" href="#low-level-structures">Low-Level Structures</a> which support both
<a class="reference internal" href="#analysis-and-profiling">Analysis and Profiling</a> and <a class="reference internal" href="#applications">Applications</a>.</p>
<div class="section" id="low-level-structures">
<h2>Low-Level Structures<a class="headerlink" href="#low-level-structures" title="Permalink to this headline">¶</a></h2>
<p>These are supporting structures which define the essential classes.</p>
<p>This includes reports, the transit system and the raw data server
from which reports are acquired.</p>
<div class="section" id="module-caravel.acquire">
<span id="acquire"></span><h3>Acquire<a class="headerlink" href="#module-caravel.acquire" title="Permalink to this headline">¶</a></h3>
<p>Caravel raw file acquire.</p>
<p>Checks FTP status and downloads latest versions of locations.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">host</span><span class="o">=</span><span class="s">&#39;216.54.15.3&#39;</span>
<span class="n">user</span><span class="o">=</span><span class="s">&#39;anonymous&#39;</span>
<span class="n">passwd</span><span class="o">=</span><span class="s">&#39;slott56@gmail.com&#39;</span>
</pre></div>
</div>
<p>Also.  Gets route information from <a class="reference external" href="http://googletf.gohrt.com/google_transit.zip">http://googletf.gohrt.com/google_transit.zip</a></p>
<dl class="function">
<dt id="caravel.acquire.get_reports">
<tt class="descclassname">caravel.acquire.</tt><tt class="descname">get_reports</tt><big>(</big><em>connection=None</em>, <em>target_dir='.'</em>, <em>**access</em><big>)</big><a class="reference internal" href="../_modules/caravel/acquire.html#get_reports"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.acquire.get_reports" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the lastest position report &#8220;file&#8221;.</p>
<p>Check for latest versions of &#8220;vid.csv&#8221; and download it only if it changed.</p>
<p>Download the current version of  <tt class="docutils literal"><span class="pre">hrtrtf.txt</span></tt> file;
naming it with a <tt class="docutils literal"><span class="pre">YYYYMMDDHHMM.rpt</span></tt> name.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>connection</strong> &#8211; Override to the default of ftplib.FTP</li>
<li><strong>target_dir</strong> &#8211; Working directory for result files</li>
<li><strong>host</strong> &#8211; IP address or name of the FTP host.</li>
<li><strong>user</strong> &#8211; FTP username</li>
<li><strong>passwd</strong> &#8211; FTP password</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="caravel.acquire.get_route">
<tt class="descclassname">caravel.acquire.</tt><tt class="descname">get_route</tt><big>(</big><em>connection=None</em>, <em>target_dir='.'</em>, <em>url='http://googletf.gohrt.com/google_transit.zip'</em><big>)</big><a class="reference internal" href="../_modules/caravel/acquire.html#get_route"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.acquire.get_route" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the lastest Route Definition ZIP Archive.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>connection</strong> &#8211; Override to the default of urllib2.OpenerDirector.</li>
<li><strong>target_dir</strong> &#8211; Working directory for result file</li>
<li><strong>url</strong> &#8211; URL for the file (<a class="reference external" href="http://googletf.gohrt.com/google_transit.zip">http://googletf.gohrt.com/google_transit.zip</a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-caravel.report">
<span id="report"></span><h3>Report<a class="headerlink" href="#module-caravel.report" title="Permalink to this headline">¶</a></h3>
<p>Caravel Report object construction.</p>
<p>This reads one (or more) YYYYMMDDHHMM.rpt raw files and creates
a sequence of Report instances.  The subclasses include</p>
<ul class="simple">
<li>Location - a simple location report; rte is None and dwell is None.</li>
<li>Dwell - a Report with route/direction/stop and dwell time;
rte is not None and dwell is not None.</li>
<li>Arrival - a Report with route/direction/stop arrived instead of dwell time
rte is not None and dwell is None.</li>
</ul>
<p>The fourth possible combination (rte is None and dwell is not None) cannot occur.</p>
<div class="section" id="report-objects">
<h4>Report Objects<a class="headerlink" href="#report-objects" title="Permalink to this headline">¶</a></h4>
<dl class="class">
<dt id="caravel.report.Report">
<em class="property">class </em><tt class="descclassname">caravel.report.</tt><tt class="descname">Report</tt><big>(</big><em>timestamp</em>, <em>id</em><big>)</big><a class="reference internal" href="../_modules/caravel/report.html#Report"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.report.Report" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract superclass of the various kinds of reports.</p>
</dd></dl>

<dl class="class">
<dt id="caravel.report.Location">
<em class="property">class </em><tt class="descclassname">caravel.report.</tt><tt class="descname">Location</tt><big>(</big><em>timestamp</em>, <em>id</em>, <em>lat</em>, <em>lon</em>, <em>ll_valid</em>, <em>adher</em>, <em>adher_valid</em>, <em>odom=None</em>, <em>odom_valid=None</em>, <em>dgps=None</em>, <em>fom=None</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="../_modules/caravel/report.html#Location"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.report.Location" title="Permalink to this definition">¶</a></dt>
<dd><p>A Location report for a Vehicle in motion.</p>
</dd></dl>

<dl class="class">
<dt id="caravel.report.Arrival">
<em class="property">class </em><tt class="descclassname">caravel.report.</tt><tt class="descname">Arrival</tt><big>(</big><em>timestamp</em>, <em>id</em>, <em>lat</em>, <em>lon</em>, <em>ll_valid</em>, <em>adher</em>, <em>adher_valid</em>, <em>odom=None</em>, <em>odom_valid=None</em>, <em>dgps=None</em>, <em>fom=None</em>, <em>time=None</em>, <em>rte=None</em>, <em>dir=None</em>, <em>tp=None</em>, <em>stop=None</em>, <em>svc=None</em>, <em>blk=None</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="../_modules/caravel/report.html#Arrival"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.report.Arrival" title="Permalink to this definition">¶</a></dt>
<dd><p>A Location report for a Vehicle arriving at a stop.</p>
</dd></dl>

<dl class="class">
<dt id="caravel.report.Dwell">
<em class="property">class </em><tt class="descclassname">caravel.report.</tt><tt class="descname">Dwell</tt><big>(</big><em>timestamp</em>, <em>id</em>, <em>lat</em>, <em>lon</em>, <em>ll_valid</em>, <em>adher</em>, <em>adher_valid</em>, <em>odom=None</em>, <em>odom_valid=None</em>, <em>dgps=None</em>, <em>fom=None</em>, <em>time=None</em>, <em>dwell=None</em>, <em>rte=None</em>, <em>dir=None</em>, <em>tp=None</em>, <em>stop=None</em>, <em>svc=None</em>, <em>blk=None</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="../_modules/caravel/report.html#Dwell"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.report.Dwell" title="Permalink to this definition">¶</a></dt>
<dd><p>A Location report for a Vehicle paused at a stop.
This is less helpful and may get filtered out.</p>
</dd></dl>

</div>
<div class="section" id="report-factory">
<h4>Report Factory<a class="headerlink" href="#report-factory" title="Permalink to this headline">¶</a></h4>
<dl class="class">
<dt id="caravel.report.ReportReader">
<em class="property">class </em><tt class="descclassname">caravel.report.</tt><tt class="descname">ReportReader</tt><big>(</big><em>year=None</em><big>)</big><a class="headerlink" href="#caravel.report.ReportReader" title="Permalink to this definition">¶</a></dt>
<dd><p>An iterator over Report items (<a class="reference internal" href="#caravel.report.Location" title="caravel.report.Location"><tt class="xref py py-class docutils literal"><span class="pre">Location</span></tt></a>, <a class="reference internal" href="#caravel.report.Arrival" title="caravel.report.Arrival"><tt class="xref py py-class docutils literal"><span class="pre">Arrival</span></tt></a>, <a class="reference internal" href="#caravel.report.Dwell" title="caravel.report.Dwell"><tt class="xref py py-class docutils literal"><span class="pre">Dwell</span></tt></a>).</p>
<p>This is the abstract superclass for various reader implementations.</p>
<p>Requires <a class="reference internal" href="#caravel.report.ReportReader.open" title="caravel.report.ReportReader.open"><tt class="xref py py-meth docutils literal"><span class="pre">ReportReader.open()</span></tt></a>
and <a class="reference internal" href="#caravel.report.ReportReader.factory" title="caravel.report.ReportReader.factory"><tt class="xref py py-meth docutils literal"><span class="pre">ReportReader.factory()</span></tt></a>.</p>
<dl class="method">
<dt id="caravel.report.ReportReader.__init__">
<tt class="descname">__init__</tt><big>(</big><em>year=None</em><big>)</big><a class="headerlink" href="#caravel.report.ReportReader.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a ReportReader_v1 with a given default year.</p>
<p>The year is required because the timestamps only have month and day.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>year</strong> &#8211; Year extracted from file name.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="caravel.report.ReportReader.__iter__">
<tt class="descname">__iter__</tt><big>(</big><big>)</big><a class="headerlink" href="#caravel.report.ReportReader.__iter__" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over Report instances in this source.</p>
</dd></dl>

<dl class="method">
<dt id="caravel.report.ReportReader.factory">
<tt class="descname">factory</tt><big>(</big><em>line</em><big>)</big><a class="headerlink" href="#caravel.report.ReportReader.factory" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse the fields, returning Arrival, Dwell or Location.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>line</strong> &#8211; line of raw input.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Report instance, if possible.  <tt class="docutils literal"><span class="pre">None</span></tt> if the fields can&#8217;t be parsed.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="caravel.report.ReportReader.open">
<tt class="descname">open</tt><big>(</big><em>source</em>, <em>year=None</em><big>)</big><a class="headerlink" href="#caravel.report.ReportReader.open" title="Permalink to this definition">¶</a></dt>
<dd><p>Open a given source for processing.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>source</strong> &#8211; an open file-like source.</li>
<li><strong>year</strong> &#8211; a potential override for the default year.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="caravel.report.ReportReader_v1">
<em class="property">class </em><tt class="descclassname">caravel.report.</tt><tt class="descname">ReportReader_v1</tt><big>(</big><em>year=None</em><big>)</big><a class="headerlink" href="#caravel.report.ReportReader_v1" title="Permalink to this definition">¶</a></dt>
<dd><p>An iterator over Report items (<a class="reference internal" href="#caravel.report.Location" title="caravel.report.Location"><tt class="xref py py-class docutils literal"><span class="pre">Location</span></tt></a>, <a class="reference internal" href="#caravel.report.Arrival" title="caravel.report.Arrival"><tt class="xref py py-class docutils literal"><span class="pre">Arrival</span></tt></a>, <a class="reference internal" href="#caravel.report.Dwell" title="caravel.report.Dwell"><tt class="xref py py-class docutils literal"><span class="pre">Dwell</span></tt></a>).</p>
<p>This handles V1 format, with space-delimited fields in the following form.</p>
<div class="highlight-python"><pre>07:04:42 02/15  V.1.2233  H.0.0  MT_LOCATION    Lat/Lon:370620935/-763413842 [Valid]  Adher:-1 [Valid]  Odom:2668 [Valid]  DGPS:On  FOM:2</pre>
</div>
<p>This is an iterable object, generally something like the following is done:</p>
<div class="highlight-python"><pre>reader= ReportReader_v1()
with open(some_file) as source:
    reader.open(some_file)
    for report in reader:
        # process report</pre>
</div>
<dl class="method">
<dt id="caravel.report.ReportReader_v1.common_fields">
<tt class="descname">common_fields</tt><big>(</big><em>fields</em><big>)</big><a class="headerlink" href="#caravel.report.ReportReader_v1.common_fields" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse the common set of fields.
These are Fields 13-20 of MT_TIMEPOINTCROSSING.
They are also Fields 5-12 of MT_LOCATION.</p>
<p>These fields are</p>
<ul class="simple">
<li>&#8220;Lat/Lon&#8221; and the following &#8220;[Valid]&#8221;/&#8221;[Invalid]&#8221; flag.</li>
<li>&#8220;Adher&#8221; and the following &#8220;[Valid]&#8221;/&#8221;[Invalid]&#8221; flag.</li>
<li>&#8220;Odom&#8221; and the following &#8220;[Valid]&#8221;/&#8221;[Invalid]&#8221; flag.</li>
<li>&#8220;DGPS&#8221;</li>
<li>&#8220;FOM&#8221;</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">tuple of (lat, lon, ll_valid, adher, adher_valid, odom, odom_valid, dgps, fom)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="caravel.report.ReportReader_v1.factory">
<tt class="descname">factory</tt><big>(</big><em>line</em><big>)</big><a class="headerlink" href="#caravel.report.ReportReader_v1.factory" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse the fields, returning Arrival, Dwell or Location.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>line</strong> &#8211; line of raw input.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Report instance, if possible.  <tt class="docutils literal"><span class="pre">None</span></tt> if the fields can&#8217;t be parsed.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="caravel.report.ReportReader_v1.label_int">
<tt class="descname">label_int</tt><big>(</big><em>field</em>, <em>expected</em><big>)</big><a class="headerlink" href="#caravel.report.ReportReader_v1.label_int" title="Permalink to this definition">¶</a></dt>
<dd><p>Split a &#8220;label:value&#8221; field, attempting an integer conversion.
If the label is not as expected, raise an exception.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>field</strong> &#8211; a &#8220;label:value field</li>
<li><strong>expected</strong> &#8211; the expected label.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">the integer value</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="caravel.report.ReportReader_v1.label_lat_lon">
<tt class="descname">label_lat_lon</tt><big>(</big><em>field</em>, <em>expected='Lat/Lon'</em><big>)</big><a class="headerlink" href="#caravel.report.ReportReader_v1.label_lat_lon" title="Permalink to this definition">¶</a></dt>
<dd><p>Split a &#8220;label:lat/lon&#8221; field, attempting an fairly complex conversion.
If the label is not as expected, raise an exception.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>field</strong> &#8211; a &#8220;label:lat/lon field</li>
<li><strong>expected</strong> &#8211; the expected label.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">(lat, lon) 2-tuple</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="caravel.report.ReportReader_v1.label_str">
<tt class="descname">label_str</tt><big>(</big><em>field</em>, <em>expected</em><big>)</big><a class="headerlink" href="#caravel.report.ReportReader_v1.label_str" title="Permalink to this definition">¶</a></dt>
<dd><p>Split a &#8220;label:value&#8221; field, doing no further conversion.
If the label is not as expected, raise an exception.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>field</strong> &#8211; a &#8220;label:value field</li>
<li><strong>expected</strong> &#8211; the expected label.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">the string value</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="caravel.report.ReportReader_v1.label_time">
<tt class="descname">label_time</tt><big>(</big><em>field</em>, <em>expected</em><big>)</big><a class="headerlink" href="#caravel.report.ReportReader_v1.label_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Split a &#8220;label:time&#8221; field, to create a seconds-after-midnight value.
If the label is not as expected, raise an exception.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>field</strong> &#8211; a &#8220;label:time field</li>
<li><strong>expected</strong> &#8211; the expected label.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">datetime.time() object.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="caravel.report.ReportReader_v1.open">
<tt class="descname">open</tt><big>(</big><em>source</em>, <em>year=None</em><big>)</big><a class="headerlink" href="#caravel.report.ReportReader_v1.open" title="Permalink to this definition">¶</a></dt>
<dd><p>Open a given source for processing.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>source</strong> &#8211; an open file-like source.</li>
<li><strong>year</strong> &#8211; a potential override for the default year.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="caravel.report.ReportReader_v1.vehicle_pat">
<tt class="descname">vehicle_pat</tt><em class="property"> = &lt;_sre.SRE_Pattern object at 0x103d4a9d0&gt;</em><a class="headerlink" href="#caravel.report.ReportReader_v1.vehicle_pat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="caravel.report.ReportReader_v2">
<em class="property">class </em><tt class="descclassname">caravel.report.</tt><tt class="descname">ReportReader_v2</tt><big>(</big><em>year=None</em><big>)</big><a class="headerlink" href="#caravel.report.ReportReader_v2" title="Permalink to this definition">¶</a></dt>
<dd><p>An iterator over Report items (<a class="reference internal" href="#caravel.report.Location" title="caravel.report.Location"><tt class="xref py py-class docutils literal"><span class="pre">Location</span></tt></a>, <a class="reference internal" href="#caravel.report.Arrival" title="caravel.report.Arrival"><tt class="xref py py-class docutils literal"><span class="pre">Arrival</span></tt></a>, <a class="reference internal" href="#caravel.report.Dwell" title="caravel.report.Dwell"><tt class="xref py py-class docutils literal"><span class="pre">Dwell</span></tt></a>).</p>
<p>This handles V2 format, which is CSV.</p>
<p>First Line:</p>
<div class="highlight-python"><pre>Time,Date,RID,Lat/Lon,Location Valid/Invalid,Adherence,Adherence Valid/Invalid[,Route,Direction,StopID]</pre>
</div>
<p>Column Titles:</p>
<blockquote>
<div><ul class="simple">
<li>&#8216;Time&#8217;</li>
<li>&#8216;Date&#8217;</li>
<li>&#8216;RID&#8217;</li>
<li>&#8216;Lat/Lon&#8217;</li>
<li>&#8216;Location Valid/Invalid&#8217;</li>
<li>&#8216;Adherence&#8217;</li>
<li>&#8216;Adherence Valid/Invalid[&#8216; # Really.</li>
<li>&#8216;Route&#8217;</li>
<li>&#8216;Direction&#8217;</li>
<li>&#8216;StopID]&#8217; # Also peculiar.</li>
</ul>
</div></blockquote>
<p>This is an iterable object, generally something like the following is done:</p>
<div class="highlight-python"><pre>reader= ReportReader_v2()
with open(some_file) as source:
    reader.open(some_file)
    for report in reader:
        # process report</pre>
</div>
<dl class="method">
<dt id="caravel.report.ReportReader_v2.factory">
<tt class="descname">factory</tt><big>(</big><em>line</em><big>)</big><a class="headerlink" href="#caravel.report.ReportReader_v2.factory" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse the fields, returning Arrival, Dwell or Location.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>line</strong> &#8211; CSV line of raw input.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Report instance, if possible.  <tt class="docutils literal"><span class="pre">None</span></tt> if the fields can&#8217;t be parsed.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="caravel.report.ReportReader_v2.open">
<tt class="descname">open</tt><big>(</big><em>source</em>, <em>year=None</em><big>)</big><a class="headerlink" href="#caravel.report.ReportReader_v2.open" title="Permalink to this definition">¶</a></dt>
<dd><p>Open a given source for processing.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>source</strong> &#8211; an open file-like source.</li>
<li><strong>year</strong> &#8211; a potential override for the default year.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="caravel.report.report_iter">
<tt class="descclassname">caravel.report.</tt><tt class="descname">report_iter</tt><big>(</big><em>report_reader</em>, <em>files</em><big>)</big><a class="reference internal" href="../_modules/caravel/report.html#report_iter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.report.report_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>An iterator which applies the <tt class="docutils literal"><span class="pre">report_reader</span></tt> instance to all
of the named files.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>report_reader</strong> &#8211; an instance of <a class="reference internal" href="#caravel.report.ReportReader" title="caravel.report.ReportReader"><tt class="xref py py-class docutils literal"><span class="pre">ReportReader</span></tt></a> which parses
input lines and creates <a class="reference internal" href="#caravel.report.Report" title="caravel.report.Report"><tt class="xref py py-class docutils literal"><span class="pre">Report</span></tt></a> instances.</li>
<li><strong>files</strong> &#8211; an iterable over the file names.
To process a single file, use <tt class="docutils literal"><span class="pre">report_iter(</span> <span class="pre">report_reader,</span> <span class="pre">[one_file]</span> <span class="pre">)</span></tt></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="json-codec">
<h4>JSON Codec<a class="headerlink" href="#json-codec" title="Permalink to this headline">¶</a></h4>
<dl class="class">
<dt id="caravel.report.JSONEncoder">
<em class="property">class </em><tt class="descclassname">caravel.report.</tt><tt class="descname">JSONEncoder</tt><big>(</big><em>skipkeys=False</em>, <em>ensure_ascii=True</em>, <em>check_circular=True</em>, <em>allow_nan=True</em>, <em>sort_keys=False</em>, <em>indent=None</em>, <em>separators=None</em>, <em>encoding='utf-8'</em>, <em>default=None</em><big>)</big><a class="reference internal" href="../_modules/caravel/report.html#JSONEncoder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.report.JSONEncoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Encode any of the Report subclasses into JSON.</p>
</dd></dl>

<dl class="class">
<dt id="caravel.report.JSONDecoder">
<em class="property">class </em><tt class="descclassname">caravel.report.</tt><tt class="descname">JSONDecoder</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="../_modules/caravel/report.html#JSONDecoder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.report.JSONDecoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Decode any of the Report subclasses from JSON.</p>
</dd></dl>

</div>
</div>
<div class="section" id="module-caravel.transit_system">
<span id="transit-system"></span><h3>Transit System<a class="headerlink" href="#module-caravel.transit_system" title="Permalink to this headline">¶</a></h3>
<p>Caravel Transit System &#8220;database&#8221;.</p>
<p>This reads the various files that define the transit system to
create an in-memory database.</p>
<ul class="simple">
<li>calendar.txt</li>
<li>calendar_dates.txt</li>
<li>routes.txt</li>
<li>stops.txt</li>
<li>trips.txt</li>
<li>stop_times.txt</li>
</ul>
<div class="section" id="transit-objects">
<h4>Transit Objects<a class="headerlink" href="#transit-objects" title="Permalink to this headline">¶</a></h4>
<dl class="class">
<dt id="caravel.transit_system.Calendar">
<em class="property">class </em><tt class="descclassname">caravel.transit_system.</tt><tt class="descname">Calendar</tt><a class="headerlink" href="#caravel.transit_system.Calendar" title="Permalink to this definition">¶</a></dt>
<dd><p>Calendar(service_id, monday, tuesday, wednesday, thursday, friday, saturday, sunday, start_date, end_date)</p>
</dd></dl>

<dl class="class">
<dt id="caravel.transit_system.Calendar_Date">
<em class="property">class </em><tt class="descclassname">caravel.transit_system.</tt><tt class="descname">Calendar_Date</tt><a class="headerlink" href="#caravel.transit_system.Calendar_Date" title="Permalink to this definition">¶</a></dt>
<dd><p>Calendar_Date(service_id, date, exception_type)</p>
</dd></dl>

<dl class="class">
<dt id="caravel.transit_system.Route">
<em class="property">class </em><tt class="descclassname">caravel.transit_system.</tt><tt class="descname">Route</tt><a class="headerlink" href="#caravel.transit_system.Route" title="Permalink to this definition">¶</a></dt>
<dd><p>Route(route_id, route_short_name, route_long_name, route_desc, route_type, route_url)</p>
</dd></dl>

<dl class="class">
<dt id="caravel.transit_system.Stop">
<em class="property">class </em><tt class="descclassname">caravel.transit_system.</tt><tt class="descname">Stop</tt><a class="headerlink" href="#caravel.transit_system.Stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Stop(stop_id, stop_name, stop_lat, stop_lon)</p>
</dd></dl>

<dl class="class">
<dt id="caravel.transit_system.Trip">
<em class="property">class </em><tt class="descclassname">caravel.transit_system.</tt><tt class="descname">Trip</tt><a class="headerlink" href="#caravel.transit_system.Trip" title="Permalink to this definition">¶</a></dt>
<dd><p>Trip(route_id, service_id, trip_id, direction_id, block_id)</p>
</dd></dl>

<dl class="class">
<dt id="caravel.transit_system.Stop_Time">
<em class="property">class </em><tt class="descclassname">caravel.transit_system.</tt><tt class="descname">Stop_Time</tt><a class="headerlink" href="#caravel.transit_system.Stop_Time" title="Permalink to this definition">¶</a></dt>
<dd><p>Stop_Time(trip_id, arrival_time, departure_time, stop_id, stop_sequence, timepoint)</p>
</dd></dl>

<dl class="class">
<dt id="caravel.transit_system.Candidate">
<em class="property">class </em><tt class="descclassname">caravel.transit_system.</tt><tt class="descname">Candidate</tt><a class="headerlink" href="#caravel.transit_system.Candidate" title="Permalink to this definition">¶</a></dt>
<dd><p>Candidate(distance, time, stop, stop_time)</p>
</dd></dl>

</div>
<div class="section" id="transit-connection">
<h4>Transit &#8220;Connection&#8221;<a class="headerlink" href="#transit-connection" title="Permalink to this headline">¶</a></h4>
<p>This is a database-like object.</p>
<dl class="class">
<dt id="caravel.transit_system.Accessor">
<em class="property">class </em><tt class="descclassname">caravel.transit_system.</tt><tt class="descname">Accessor</tt><a class="reference internal" href="../_modules/caravel/transit_system.html#Accessor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.transit_system.Accessor" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract superclass to unify access to a directory and access to
a ZIP archive.</p>
</dd></dl>

<dl class="class">
<dt id="caravel.transit_system.AccessZip">
<em class="property">class </em><tt class="descclassname">caravel.transit_system.</tt><tt class="descname">AccessZip</tt><big>(</big><em>archive</em><big>)</big><a class="reference internal" href="../_modules/caravel/transit_system.html#AccessZip"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.transit_system.AccessZip" title="Permalink to this definition">¶</a></dt>
<dd><p>Access a ZIP archive.</p>
<dl class="method">
<dt id="caravel.transit_system.AccessZip.open">
<tt class="descname">open</tt><big>(</big><em>name</em>, <em>mode='r'</em><big>)</big><a class="reference internal" href="../_modules/caravel/transit_system.html#AccessZip.open"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.transit_system.AccessZip.open" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an open file object for the named member.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="caravel.transit_system.AccessDir">
<em class="property">class </em><tt class="descclassname">caravel.transit_system.</tt><tt class="descname">AccessDir</tt><big>(</big><em>base</em><big>)</big><a class="reference internal" href="../_modules/caravel/transit_system.html#AccessDir"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.transit_system.AccessDir" title="Permalink to this definition">¶</a></dt>
<dd><p>Access a Directory (an archive that&#8217;s been expanded.)</p>
<dl class="method">
<dt id="caravel.transit_system.AccessDir.open">
<tt class="descname">open</tt><big>(</big><em>name</em>, <em>mode='rb'</em><big>)</big><a class="reference internal" href="../_modules/caravel/transit_system.html#AccessDir.open"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.transit_system.AccessDir.open" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an open file object for the named member.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="caravel.transit_system.Connection">
<em class="property">class </em><tt class="descclassname">caravel.transit_system.</tt><tt class="descname">Connection</tt><a class="reference internal" href="../_modules/caravel/transit_system.html#Connection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.transit_system.Connection" title="Permalink to this definition">¶</a></dt>
<dd><p>Open a database-like connection to the transit data.
This will eagerly load all the files, creating a large (but fast) in-memory database.</p>
<dl class="method">
<dt id="caravel.transit_system.Connection.open">
<tt class="descname">open</tt><big>(</big><em>base</em><big>)</big><a class="reference internal" href="../_modules/caravel/transit_system.html#Connection.open"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.transit_system.Connection.open" title="Permalink to this definition">¶</a></dt>
<dd><p>Open the given .ZIP file or directory.  This will eagerly load
the files.  It takes a second or two.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>base</strong> &#8211; Directory name or .ZIP file name.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="caravel.transit_system.Connection.time_parse">
<em class="property">static </em><tt class="descname">time_parse</tt><big>(</big><em>string</em><big>)</big><a class="reference internal" href="../_modules/caravel/transit_system.html#Connection.time_parse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.transit_system.Connection.time_parse" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform HH:MM:SS string into seconds past midnight.
Unlike <tt class="xref py py-mod docutils literal"><span class="pre">datetime</span></tt>, this does not mind times &gt;= 24:00:00.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>string</strong> &#8211; String of the form HH:MM:SS</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">seconds past midnigth</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="query-functions">
<h4>Query Functions<a class="headerlink" href="#query-functions" title="Permalink to this headline">¶</a></h4>
<dl class="function">
<dt id="caravel.transit_system.radians">
<tt class="descclassname">caravel.transit_system.</tt><tt class="descname">radians</tt><big>(</big><em>degrees</em><big>)</big><a class="reference internal" href="../_modules/caravel/transit_system.html#radians"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.transit_system.radians" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert Lat/Lon degrees to radians.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>degrees</strong> &#8211; Latitude or Longitude</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Radians</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="caravel.transit_system.degrees">
<tt class="descclassname">caravel.transit_system.</tt><tt class="descname">degrees</tt><big>(</big><em>radians</em><big>)</big><a class="reference internal" href="../_modules/caravel/transit_system.html#degrees"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.transit_system.degrees" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert radians to Lat/Lon degrees.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>radians</strong> &#8211; angle in radians, usually from a distance calculation</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Degrees</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="caravel.transit_system.dist_approx">
<tt class="descclassname">caravel.transit_system.</tt><tt class="descname">dist_approx</tt><big>(</big><em>p1</em>, <em>p2</em><big>)</big><a class="reference internal" href="../_modules/caravel/transit_system.html#dist_approx"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.transit_system.dist_approx" title="Permalink to this definition">¶</a></dt>
<dd><p>The Equirectangular Approximation for distance between two coordinates.
Fast and reasonably accurate.</p>
<p>See <a class="reference internal" href="../design/distance.html#design-distance"><em>Distance Calculations</em></a> for details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>p1</strong> &#8211; (lat,lon) 2-tuple</li>
<li><strong>p2</strong> &#8211; (lat,lon) 2-tuple</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">distance in statute miles.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="caravel.transit_system.get_services_today">
<tt class="descclassname">caravel.transit_system.</tt><tt class="descname">get_services_today</tt><big>(</big><em>conn</em>, <em>today=None</em><big>)</big><a class="reference internal" href="../_modules/caravel/transit_system.html#get_services_today"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.transit_system.get_services_today" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Service ID applicable today.
Examines calendar and calendar dates.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>conn</strong> &#8211; An open <a class="reference internal" href="#caravel.transit_system.Connection" title="caravel.transit_system.Connection"><tt class="xref py py-class docutils literal"><span class="pre">Connection</span></tt></a>.</li>
<li><strong>today</strong> &#8211; A <tt class="xref py py-class docutils literal"><span class="pre">datetime.date</span></tt> object.
If omitted, the current date is used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A sequence of service id strings that apply to this date.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="caravel.transit_system.get_closest_stops">
<tt class="descclassname">caravel.transit_system.</tt><tt class="descname">get_closest_stops</tt><big>(</big><em>conn</em>, <em>lat_lon</em>, <em>max_dist=None</em><big>)</big><a class="reference internal" href="../_modules/caravel/transit_system.html#get_closest_stops"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.transit_system.get_closest_stops" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a lat/lon pair, locate nearby stops.</p>
<p>Handles the following REST requests.</p>
<p><tt class="samp docutils literal"><span class="pre">/stop/?latlng=</span><em><span class="pre">nn.nnnnnn,mm.mmmmmm</span></em></tt></p>
<blockquote>
<div>This can find the nearest stops to this coordinate.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>conn</strong> &#8211; An open <a class="reference internal" href="#caravel.transit_system.Connection" title="caravel.transit_system.Connection"><tt class="xref py py-class docutils literal"><span class="pre">Connection</span></tt></a>.</li>
<li><strong>lat_lon</strong> &#8211; A (lat,lon) 2-tuple</li>
<li><strong>max_dist</strong> &#8211; An upper limit on distances to examine</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">iterator over (distance,stop) pairs ordered from nearest to
the specified max_dist value.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="caravel.transit_system.get_closest_times_in_service">
<tt class="descclassname">caravel.transit_system.</tt><tt class="descname">get_closest_times_in_service</tt><big>(</big><em>conn</em>, <em>stop_id</em>, <em>time</em>, <em>services</em>, <em>min_time=None</em>, <em>max_time=None</em><big>)</big><a class="reference internal" href="../_modules/caravel/transit_system.html#get_closest_times_in_service"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.transit_system.get_closest_times_in_service" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a stop and a time, locate the scheduled stop_time closest to this.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>conn</strong> &#8211; An open <a class="reference internal" href="#caravel.transit_system.Connection" title="caravel.transit_system.Connection"><tt class="xref py py-class docutils literal"><span class="pre">Connection</span></tt></a>.</li>
<li><strong>stop_id</strong> &#8211; The id for a stop</li>
<li><strong>time</strong> &#8211; The seconds-after-midnight time</li>
<li><strong>services</strong> &#8211; The iterable sequence of services applicable</li>
<li><strong>min_time</strong> &#8211; The lower limit on seconds prior to the scheduled time.
Usually, this is a negative number.</li>
<li><strong>max_time</strong> &#8211; The upper limit on seconds after the the scheduled time.
This is a positive number.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">iterator over (time,stop_time) pairs ordered from closest in time
to the max_time value.  The absolute magnitude is used for sorting
so early and late times will be intermixed.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="caravel.transit_system.get_candidate_stops">
<tt class="descclassname">caravel.transit_system.</tt><tt class="descname">get_candidate_stops</tt><big>(</big><em>conn</em>, <em>lat_lon</em>, <em>time</em>, <em>services</em>, <em>max_dist=None</em>, <em>min_time=None</em>, <em>max_time=None</em>, <em>count=6</em><big>)</big><a class="reference internal" href="../_modules/caravel/transit_system.html#get_candidate_stops"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.transit_system.get_candidate_stops" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the most likely stops to match a report&#8217;s lat/lon and time.
This will use <a class="reference internal" href="#caravel.transit_system.get_closest_stops" title="caravel.transit_system.get_closest_stops"><tt class="xref py py-meth docutils literal"><span class="pre">get_closest_stops()</span></tt></a> to locate a collection of likely stops.
For each stop, <a class="reference internal" href="#caravel.transit_system.get_closest_times_in_service" title="caravel.transit_system.get_closest_times_in_service"><tt class="xref py py-meth docutils literal"><span class="pre">get_closest_times_in_service()</span></tt></a> is used to locate the
most likely scheduled time before or after the reported time.</p>
<p>Initial surveys of the data provided guidance on the upper bounds
for time and distance matching.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>conn</strong> &#8211; An open <a class="reference internal" href="#caravel.transit_system.Connection" title="caravel.transit_system.Connection"><tt class="xref py py-class docutils literal"><span class="pre">Connection</span></tt></a>.</li>
<li><strong>lat_lon</strong> &#8211; A (lat,lon) tuple from a <a class="reference internal" href="#caravel.report.Report" title="caravel.report.Report"><tt class="xref py py-class docutils literal"><span class="pre">caravel.report.Report</span></tt></a> instance.</li>
<li><strong>time</strong> &#8211; A time (seconds past midnight) from a <a class="reference internal" href="#caravel.report.Report" title="caravel.report.Report"><tt class="xref py py-class docutils literal"><span class="pre">caravel.report.Report</span></tt></a> instance.</li>
<li><strong>services</strong> &#8211; The iterable sequence of services applicable</li>
<li><strong>max_dist</strong> &#8211; An upper limit on distances to examine.  The default value is 0.1 mile.</li>
<li><strong>min_time</strong> &#8211; The lower limit on seconds prior to the scheduled time.
Usually, this is a negative number.  The default is about -180 seconds.</li>
<li><strong>max_time</strong> &#8211; The upper limit on seconds after the the scheduled time.
This is a positive number.  The default is about 360 seconds.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="caravel.transit_system.get_route_from_stop_time">
<tt class="descclassname">caravel.transit_system.</tt><tt class="descname">get_route_from_stop_time</tt><big>(</big><em>conn</em>, <em>stop_time</em><big>)</big><a class="reference internal" href="../_modules/caravel/transit_system.html#get_route_from_stop_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.transit_system.get_route_from_stop_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Query the route that contains a given stop_time value.
This does a stop_times JOIN trips JOIN routes query.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>conn</strong> &#8211; An open <a class="reference internal" href="#caravel.transit_system.Connection" title="caravel.transit_system.Connection"><tt class="xref py py-class docutils literal"><span class="pre">Connection</span></tt></a>.</li>
<li><strong>stop_time</strong> &#8211; a <a class="reference internal" href="#caravel.transit_system.Stop_Time" title="caravel.transit_system.Stop_Time"><tt class="xref py py-class docutils literal"><span class="pre">Stop_Time</span></tt></a> instance.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">a <a class="reference internal" href="#caravel.transit_system.Route" title="caravel.transit_system.Route"><tt class="xref py py-class docutils literal"><span class="pre">Route</span></tt></a> instance.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="caravel.transit_system.get_trip_from_stop_time">
<tt class="descclassname">caravel.transit_system.</tt><tt class="descname">get_trip_from_stop_time</tt><big>(</big><em>conn</em>, <em>stop_time</em><big>)</big><a class="reference internal" href="../_modules/caravel/transit_system.html#get_trip_from_stop_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.transit_system.get_trip_from_stop_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Query the trip that contains a given stop_time value.
This does a stop_times JOIN trips JOIN routes query.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>conn</strong> &#8211; An open <a class="reference internal" href="#caravel.transit_system.Connection" title="caravel.transit_system.Connection"><tt class="xref py py-class docutils literal"><span class="pre">Connection</span></tt></a>.</li>
<li><strong>stop_time</strong> &#8211; a <a class="reference internal" href="#caravel.transit_system.Stop_Time" title="caravel.transit_system.Stop_Time"><tt class="xref py py-class docutils literal"><span class="pre">Stop_Time</span></tt></a> instance.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">a <a class="reference internal" href="#caravel.transit_system.Trip" title="caravel.transit_system.Trip"><tt class="xref py py-class docutils literal"><span class="pre">Trip</span></tt></a> instance.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="caravel.transit_system.get_next_stop_time">
<tt class="descclassname">caravel.transit_system.</tt><tt class="descname">get_next_stop_time</tt><big>(</big><em>conn</em>, <em>stop_time</em>, <em>services</em><big>)</big><a class="reference internal" href="../_modules/caravel/transit_system.html#get_next_stop_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.transit_system.get_next_stop_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a <a class="reference internal" href="#caravel.transit_system.Stop_Time" title="caravel.transit_system.Stop_Time"><tt class="xref py py-class docutils literal"><span class="pre">Stop_Time</span></tt></a> object, locate the remaining
sequence of stops.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>conn</strong> &#8211; An open <a class="reference internal" href="#caravel.transit_system.Connection" title="caravel.transit_system.Connection"><tt class="xref py py-class docutils literal"><span class="pre">Connection</span></tt></a>.</li>
<li><strong>stop_time</strong> &#8211; A <a class="reference internal" href="#caravel.transit_system.Stop_Time" title="caravel.transit_system.Stop_Time"><tt class="xref py py-class docutils literal"><span class="pre">Stop_Time</span></tt></a> object</li>
<li><strong>services</strong> &#8211; The iterable sequence of services applicable</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">iterator over (time,stop_time) pairs ordered from closest in time
to the max_time value.  The absolute magnitude is used for sorting
so early and late times will be intermixed.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="caravel.transit_system.get_route">
<tt class="descclassname">caravel.transit_system.</tt><tt class="descname">get_route</tt><big>(</big><em>conn</em>, <em>id=None</em><big>)</big><a class="reference internal" href="../_modules/caravel/transit_system.html#get_route"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.transit_system.get_route" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns route or list of routes.
Handles the following REST requests.</p>
<p><tt class="samp docutils literal"><span class="pre">/route/</span></tt></p>
<blockquote>
<div>The route list.  All 70.</div></blockquote>
<p><tt class="samp docutils literal"><span class="pre">/route/</span><em><span class="pre">id</span></em><span class="pre">/</span></tt></p>
<blockquote>
<div>All stops along the route, each stop decorated with direction and service.
The time-of-day details for a given trip are not provided; they are associated
with a specific stop.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>conn</strong> &#8211; An open <a class="reference internal" href="#caravel.transit_system.Connection" title="caravel.transit_system.Connection"><tt class="xref py py-class docutils literal"><span class="pre">Connection</span></tt></a>.</li>
<li><strong>id</strong> &#8211; Optional route id.  If no route id, all routes are returned.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">route or list of routes.  Each route is a 3-tuple of (route, trip_list)
Each trip list is a sequence of stop_times.  Stop details are not included.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="caravel.transit_system.get_stop">
<tt class="descclassname">caravel.transit_system.</tt><tt class="descname">get_stop</tt><big>(</big><em>conn</em>, <em>id=None</em><big>)</big><a class="reference internal" href="../_modules/caravel/transit_system.html#get_stop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.transit_system.get_stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns stop or list of stops.
Handles the following REST requests.</p>
<p><tt class="samp docutils literal"><span class="pre">/stop/</span></tt></p>
<blockquote>
<div>All 3210 stops.</div></blockquote>
<p><tt class="samp docutils literal"><span class="pre">/stop/</span><em><span class="pre">id</span></em><span class="pre">/</span></tt></p>
<blockquote>
<div>A specific stop.</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="caravel.transit_system.get_route_stops">
<tt class="descclassname">caravel.transit_system.</tt><tt class="descname">get_route_stops</tt><big>(</big><em>conn</em>, <em>id</em>, <em>dir=None</em>, <em>date=None</em>, <em>time=None</em><big>)</big><a class="reference internal" href="../_modules/caravel/transit_system.html#get_route_stops"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.transit_system.get_route_stops" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a route with a list of stops on that route.
Handles the following REST requests.</p>
<p><tt class="samp docutils literal"><span class="pre">/route/</span><em><span class="pre">id</span></em><span class="pre">/</span><em><span class="pre">dir</span></em></tt></p>
<blockquote>
<div>All stops in a particular direction along the route.  The direction is
more-or-less inoound or outbound, and is actually a foreign key to a direction
table.</div></blockquote>
<p><tt class="samp docutils literal"><span class="pre">/route/</span><em><span class="pre">id</span></em><span class="pre">/?date=</span><em><span class="pre">date</span></em></tt></p>
<blockquote>
<div>All stops along the route filtered by services available on the given date.
Day of week is generally sufficient, but there are calendar overrides,
so full date is required.</div></blockquote>
<p><tt class="samp docutils literal"><span class="pre">/route/</span><em><span class="pre">id</span></em><span class="pre">/?date=</span><em><span class="pre">date</span></em><span class="pre">&amp;time=</span><em><span class="pre">time</span></em></tt></p>
<blockquote>
<div>All stops along the route, filtered by services available on the given date
on or after the given time.  If these are ordered by distance (along the route&#8217;s
direction) it should provide a tidy summary of the route.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>conn</strong> &#8211; An open <a class="reference internal" href="#caravel.transit_system.Connection" title="caravel.transit_system.Connection"><tt class="xref py py-class docutils literal"><span class="pre">Connection</span></tt></a>.</li>
<li><strong>id</strong> &#8211; route id.</li>
<li><strong>dir</strong> &#8211; optional direction, codes are &#8216;1&#8217; and &#8216;0&#8217;.</li>
<li><strong>date</strong> &#8211; a datetime.date object; the services available on this date
are used to filter the results.</li>
<li><strong>time</strong> &#8211; a seconds-after-midnight time.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="caravel.transit_system.get_stop_times">
<tt class="descclassname">caravel.transit_system.</tt><tt class="descname">get_stop_times</tt><big>(</big><em>conn</em>, <em>id</em>, <em>dir=None</em>, <em>date=None</em>, <em>time=None</em><big>)</big><a class="reference internal" href="../_modules/caravel/transit_system.html#get_stop_times"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.transit_system.get_stop_times" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a stop with a list of stop times.
Handles the following REST requests.</p>
<p><tt class="samp docutils literal"><span class="pre">/stop/</span><em><span class="pre">id</span></em><span class="pre">/?dir=</span><em><span class="pre">dir</span></em></tt></p>
<blockquote>
<div>All stop times for this stop constrained by trip direction.</div></blockquote>
<p><tt class="samp docutils literal"><span class="pre">/stop/</span><em><span class="pre">id</span></em><span class="pre">/?dir=</span><em><span class="pre">dir</span></em><span class="pre">&amp;date=</span><em><span class="pre">date</span></em></tt></p>
<blockquote>
<div>All stop times for this stop constrained by services on the specific date.</div></blockquote>
<p><tt class="samp docutils literal"><span class="pre">/stop/</span><em><span class="pre">id</span></em><span class="pre">/?dir=</span><em><span class="pre">dir</span></em><span class="pre">&amp;date=</span><em><span class="pre">date</span></em><span class="pre">&amp;time=</span><em><span class="pre">time</span></em></tt></p>
<p>All stop times at this stop, filtered by services available on the given date
on or after the given time</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>conn</strong> &#8211; An open <a class="reference internal" href="#caravel.transit_system.Connection" title="caravel.transit_system.Connection"><tt class="xref py py-class docutils literal"><span class="pre">Connection</span></tt></a>.</li>
<li><strong>id</strong> &#8211; stop id.</li>
<li><strong>dir</strong> &#8211; optional route direction, codes are &#8216;1&#8217; and &#8216;0&#8217;.</li>
<li><strong>date</strong> &#8211; a datetime.date object; the services available on this date
are used to filter the results.</li>
<li><strong>time</strong> &#8211; a seconds-after-midnight time.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="caravel.transit_system.get_closest_stops_filtered">
<tt class="descclassname">caravel.transit_system.</tt><tt class="descname">get_closest_stops_filtered</tt><big>(</big><em>conn</em>, <em>lat_lon</em>, <em>max_dist=None</em>, <em>dir=None</em>, <em>date=None</em>, <em>time=None</em><big>)</big><a class="reference internal" href="../_modules/caravel/transit_system.html#get_closest_stops_filtered"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.transit_system.get_closest_stops_filtered" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a lat/lon pair, locate nearby stops.</p>
<p>Handles the following REST requests.</p>
<p><tt class="samp docutils literal"><span class="pre">/stop/?latlng=</span><em><span class="pre">nn.nnnnnn,mm.mmmmmm</span></em><span class="pre">&amp;dir=</span><em><span class="pre">dir</span></em></tt></p>
<blockquote>
<div>This can find the nearest stops for all routes heading in this direction.</div></blockquote>
<p><tt class="samp docutils literal"><span class="pre">/stop/?latlng=</span><em><span class="pre">nn.nnnnnn,mm.mmmmmm</span></em><span class="pre">&amp;date=</span><em><span class="pre">date</span></em></tt></p>
<blockquote>
<div>This finds the nearest stops with a service that is active on the given date.</div></blockquote>
<p><tt class="samp docutils literal"><span class="pre">/stop/?latlng=</span><em><span class="pre">nn.nnnnnn,mm.mmmmmm</span></em><span class="pre">&amp;time=</span><em><span class="pre">time</span></em></tt></p>
<blockquote>
<div>This finds the nearest stops with a service that is active on the given date
and on or after the given time.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>conn</strong> &#8211; An open <a class="reference internal" href="#caravel.transit_system.Connection" title="caravel.transit_system.Connection"><tt class="xref py py-class docutils literal"><span class="pre">Connection</span></tt></a>.</li>
<li><strong>lat_lon</strong> &#8211; A (lat,lon) 2-tuple</li>
<li><strong>dir</strong> &#8211; A trip direction_id</li>
<li><strong>max_dist</strong> &#8211; An upper limit on distances to examine</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">iterator over (distance,stop) pairs ordered from nearest to
the specified max_dist value.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="caravel.transit_system.get_closest_routes_filtered">
<tt class="descclassname">caravel.transit_system.</tt><tt class="descname">get_closest_routes_filtered</tt><big>(</big><em>conn</em>, <em>lat_lon</em>, <em>id</em>, <em>dir=None</em>, <em>max_dist=None</em>, <em>date=None</em>, <em>time=None</em><big>)</big><a class="reference internal" href="../_modules/caravel/transit_system.html#get_closest_routes_filtered"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.transit_system.get_closest_routes_filtered" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a lat/lon pair, locate nearby stops on a given route.</p>
<p>Handles the following REST requests.</p>
<p><tt class="samp docutils literal"><span class="pre">/route/</span><em><span class="pre">id</span></em><span class="pre">/?latlng=</span><em><span class="pre">nn.nnnnnn,mm.mmmmmm</span></em></tt></p>
<blockquote>
<div>This can find the nearest stops on the given route to this coordinate.</div></blockquote>
<p><tt class="samp docutils literal"><span class="pre">/route/</span><em><span class="pre">id</span></em><span class="pre">/</span><em><span class="pre">dir</span></em><span class="pre">/?latlng=</span><em><span class="pre">nn.nnnnnn,mm.mmmmmm</span></em></tt></p>
<blockquote>
<div>This can find the nearest stops on the given route and direction to this coordinate.</div></blockquote>
<p><tt class="samp docutils literal"><span class="pre">/route/</span><em><span class="pre">id</span></em><span class="pre">/</span><em><span class="pre">dir</span></em><span class="pre">/?latlng=</span><em><span class="pre">nn.nnnnnn,mm.mmmmmm</span></em><span class="pre">&amp;date=</span><em><span class="pre">date</span></em></tt></p>
<blockquote>
<div>This can find the nearest stops on the given route and direction to this coordinate
active on the given date.</div></blockquote>
<p><tt class="samp docutils literal"><span class="pre">/route/</span><em><span class="pre">id</span></em><span class="pre">/</span><em><span class="pre">dir</span></em><span class="pre">/?latlng=</span><em><span class="pre">nn.nnnnnn,mm.mmmmmm</span></em><span class="pre">&amp;date=</span><em><span class="pre">date</span></em><span class="pre">&amp;time=</span><em><span class="pre">time</span></em></tt></p>
<blockquote>
<div>This can find the nearest stops on the given route and direction to this coordinate
active on the given date and on or after the given time.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>conn</strong> &#8211; An open <a class="reference internal" href="#caravel.transit_system.Connection" title="caravel.transit_system.Connection"><tt class="xref py py-class docutils literal"><span class="pre">Connection</span></tt></a>.</li>
<li><strong>lat_lon</strong> &#8211; A (lat,lon) 2-tuple</li>
<li><strong>dir</strong> &#8211; A trip direction_id</li>
<li><strong>max_dist</strong> &#8211; An upper limit on distances to examine</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Paran id:</th><td class="field-body"><p class="first">route id</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">iterator over (distance,stop) pairs ordered from nearest to
the specified max_dist value.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
</div>
<div class="section" id="analysis-and-profiling">
<h2>Analysis and Profiling<a class="headerlink" href="#analysis-and-profiling" title="Permalink to this headline">¶</a></h2>
<p>These are analysis and profiling modules and applications.</p>
<div class="section" id="module-caravel.statistics">
<span id="statistics"></span><h3>Statistics<a class="headerlink" href="#module-caravel.statistics" title="Permalink to this headline">¶</a></h3>
<p>Statistics tools for working with frequency counts.</p>
<dl class="class">
<dt id="caravel.statistics.FQTable">
<em class="property">class </em><tt class="descclassname">caravel.statistics.</tt><tt class="descname">FQTable</tt><a class="reference internal" href="../_modules/caravel/statistics.html#FQTable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.statistics.FQTable" title="Permalink to this definition">¶</a></dt>
<dd><p>Subclass of <tt class="xref py py-class docutils literal"><span class="pre">collections.defaultdict</span></tt> that
enforces an integer count similar to <tt class="xref py py-class docutils literal"><span class="pre">collections.Count</span></tt>
but also adds mean and standard deviation descriptive statistics.</p>
<p>Note that the summary statistics are stateful; they&#8217;re computed
once and memoized.  They must be manually reset of the collection
is changed.</p>
<dl class="method">
<dt id="caravel.statistics.FQTable.mean">
<tt class="descname">mean</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/caravel/statistics.html#FQTable.mean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.statistics.FQTable.mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the mean of this frequency table.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">mean</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="caravel.statistics.FQTable.reset">
<tt class="descname">reset</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/caravel/statistics.html#FQTable.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.statistics.FQTable.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the descriptive statistics.</p>
</dd></dl>

<dl class="method">
<dt id="caravel.statistics.FQTable.sd">
<tt class="descname">sd</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/caravel/statistics.html#FQTable.sd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.statistics.FQTable.sd" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the standard deviation of this frequency table.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">standard deviation.  Returns None if there are fewer
than 2 items.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-caravel.arrival_stats">
<span id="arrival-statistics"></span><h3>Arrival Statistics<a class="headerlink" href="#module-caravel.arrival_stats" title="Permalink to this headline">¶</a></h3>
<p>Caravel Arrival Time and Location Matching Statistics</p>
<p>This examines a suite of *.rpt files to get a bunch of Arrival and Dwell
reports.  It matches the Arrival and Dwell reports against the transit map,
getting a fairly large number of candidate matches.</p>
<dl class="function">
<dt id="caravel.arrival_stats.arrival_stats">
<tt class="descclassname">caravel.arrival_stats.</tt><tt class="descname">arrival_stats</tt><big>(</big><em>reader</em>, <em>conn</em>, <em>base='.'</em><big>)</big><a class="reference internal" href="../_modules/caravel/arrival_stats.html#arrival_stats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.arrival_stats.arrival_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the <tt class="xref py py-meth docutils literal"><span class="pre">transit_system.connection.get_candidate_stops()</span></tt> to locate
stops.  Compare the shortest distance stop with stops farther away to see
if the time match of a later stop is better than the time match of the
closest stop.</p>
</dd></dl>

</div>
<div class="section" id="module-caravel.transit_stats">
<span id="transit-system-statistics"></span><h3>Transit System Statistics<a class="headerlink" href="#module-caravel.transit_stats" title="Permalink to this headline">¶</a></h3>
<p>Caravel Transit System Statistics</p>
<p>This computes the overall average time between stops along all routes.</p>
<p>It computes the overall average distance between stops along all routes.</p>
<dl class="function">
<dt id="caravel.transit_stats.route_size">
<tt class="descclassname">caravel.transit_stats.</tt><tt class="descname">route_size</tt><big>(</big><em>conn</em><big>)</big><a class="reference internal" href="../_modules/caravel/transit_stats.html#route_size"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.transit_stats.route_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Examine all stops to get the complete bounding rectangle
of lat/lon coordinates.</p>
</dd></dl>

<dl class="function">
<dt id="caravel.transit_stats.route_stop_stats">
<tt class="descclassname">caravel.transit_stats.</tt><tt class="descname">route_stop_stats</tt><big>(</big><em>conn</em><big>)</big><a class="reference internal" href="../_modules/caravel/transit_stats.html#route_stop_stats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.transit_stats.route_stop_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>These are simple descriptive statistics of distances
between stops and distances between arrival times along
the defined routes.</p>
</dd></dl>

</div>
</div>
<div class="section" id="applications">
<h2>Applications<a class="headerlink" href="#applications" title="Permalink to this headline">¶</a></h2>
<p>These are top-level applications to produce useful results.</p>
<div class="section" id="module-caravel.split">
<span id="split"></span><h3>Split<a class="headerlink" href="#module-caravel.split" title="Permalink to this headline">¶</a></h3>
<p>Filter and split raw input to separate Location reports from Arrival reports.</p>
<p>Synopsis</p>
<div class="highlight-python"><pre>python2.7 -m caravel.split [--new] [-l location] [-a arrival] source...</pre>
</div>
<p>Description</p>
<blockquote>
<div>For each source file, filter the invalid Reports.  Split into two CSV files.
One file gets Arrival and Dwell reports.  The other file gets Location reports.</div></blockquote>
<p>Options</p>
<blockquote>
<div><dl class="option">
<dt id="cmdoption-split--format">
<tt class="descname">--format</tt><tt class="descclassname"> number</tt><a class="headerlink" href="#cmdoption-split--format" title="Permalink to this definition">¶</a></dt>
<dd><p>Format number.  Generally maps to a subclass of <a class="reference internal" href="#caravel.report.ReportReader" title="caravel.report.ReportReader"><tt class="xref py py-class docutils literal"><span class="pre">caravel.report.ReportReader</span></tt></a>.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-split--new">
<tt class="descname">--new</tt><tt class="descclassname"></tt><tt class="descclassname">, </tt><tt class="descname">-n</tt><tt class="descclassname"></tt><a class="headerlink" href="#cmdoption-split--new" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a new, live report file.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-split--location">
<tt class="descname">--location</tt><tt class="descclassname"> &lt;file&gt;</tt><tt class="descclassname">, </tt><tt class="descname">-l</tt><tt class="descclassname"> &lt;file&gt;</tt><a class="headerlink" href="#cmdoption-split--location" title="Permalink to this definition">¶</a></dt>
<dd><p>The name of the Location reports (&#8216;location.csv&#8217; is the default)</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-split--arrival">
<tt class="descname">--arrival</tt><tt class="descclassname"> &lt;file&gt;</tt><tt class="descclassname">, </tt><tt class="descname">-a</tt><tt class="descclassname"> &lt;file&gt;</tt><a class="headerlink" href="#cmdoption-split--arrival" title="Permalink to this definition">¶</a></dt>
<dd><p>The name of the Arrival/Dwell reports (&#8216;arrival.csv&#8217; is the default)</p>
</dd></dl>

<dl class="option">
<dt>
<tt class="descname">source...</tt></dt>
<dd><p>List of source files to process.</p>
</dd></dl>

</div></blockquote>
<p>Components</p>
<blockquote>
<div><dl class="function">
<dt id="caravel.split.split">
<tt class="descclassname">caravel.split.</tt><tt class="descname">split</tt><big>(</big><em>report_iter</em>, <em>location_csv</em>, <em>arrival_csv</em><big>)</big><a class="reference internal" href="../_modules/caravel/split.html#split"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.split.split" title="Permalink to this definition">¶</a></dt>
<dd><p>Split a collection of reports into two subclass: Locations and Arrivals.</p>
<p>Generally, the report_iter is an instance of <a class="reference internal" href="#caravel.report.report_iter" title="caravel.report.report_iter"><tt class="xref py py-func docutils literal"><span class="pre">caravel.report.report_iter()</span></tt></a>.</p>
<p>It&#8217;s usually built like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">reader</span><span class="o">=</span> <span class="n">caravel</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">ReportReader_v1</span><span class="p">()</span>
<span class="n">rpt_iter</span><span class="o">=</span> <span class="n">caravel</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">report_iter</span><span class="p">(</span> <span class="n">reader</span><span class="p">,</span> <span class="p">[</span><span class="nb">list</span><span class="p">,</span><span class="n">of</span><span class="p">,</span><span class="n">files</span><span class="p">]</span> <span class="p">)</span>
</pre></div>
</div>
<p>This iterator will examine all the files in the list, extracting
all Report objects.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>report_iter</strong> &#8211; an iterator over <a class="reference internal" href="#caravel.report.Report" title="caravel.report.Report"><tt class="xref py py-class docutils literal"><span class="pre">caravel.report.Report</span></tt></a> instances.</li>
<li><strong>location_csv</strong> &#8211; Name of a file to open and write.  This gets Location reports.</li>
<li><strong>arrival_csv</strong> &#8211; Name of a file to open and write. This gets
Arrival and Dwell reports.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="caravel.split.get_args">
<tt class="descclassname">caravel.split.</tt><tt class="descname">get_args</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/caravel/split.html#get_args"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.split.get_args" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse command-line arguments.
:returns: Arguments object.</p>
</dd></dl>

</div></blockquote>
</div>
<div class="section" id="module-caravel.arrival_at_stop">
<span id="arrival-at-stop"></span><h3>Arrival At Stop<a class="headerlink" href="#module-caravel.arrival_at_stop" title="Permalink to this headline">¶</a></h3>
<p>From live Arrival and Dwell records, compute the closest stop.</p>
<p>Synopsis</p>
<div class="highlight-python"><pre>python -m caraval.arrival_at_stop -t hrt_20120218_0425 *.rpt</pre>
</div>
<p>Description</p>
<blockquote>
<div><p>Uses the supplied transit information directory to gather information
on the transit system.</p>
<p>Reads the given raw *.rpt feed to get bus Reports.</p>
<p>Each Arrival or Dwell report is matched against a stop to determine where
the vehicle is and how it stands with respect to it&#8217;s schedule.
This creates a CSV file with the Report, Stop, Stop Time, Route and Trip information.</p>
<p>Some Reports cannot be matched against a stop, these reports are written
to a &#8220;reject&#8221; file, possibly including one or two stops near the report.</p>
</div></blockquote>
<p>Options</p>
<blockquote>
<div><dl class="option">
<dt>
<tt class="descname">*.rpt...</tt></dt>
<dd><p>List of source files to process.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-arrival_at_stop--format">
<tt class="descname">--format</tt><tt class="descclassname"> number</tt><a class="headerlink" href="#cmdoption-arrival_at_stop--format" title="Permalink to this definition">¶</a></dt>
<dd><p>Format number.  Generally maps to a subclass of <a class="reference internal" href="#caravel.report.ReportReader" title="caravel.report.ReportReader"><tt class="xref py py-class docutils literal"><span class="pre">caravel.report.ReportReader</span></tt></a>.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-arrival_at_stop--new">
<tt class="descname">--new</tt><tt class="descclassname"></tt><a class="headerlink" href="#cmdoption-arrival_at_stop--new" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a new .rpt file and process it.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-arrival_at_stop--transit">
<tt class="descname">--transit</tt><tt class="descclassname"> transit_details</tt><tt class="descclassname">, </tt><tt class="descname">-t</tt><tt class="descclassname"> transit_details</tt><a class="headerlink" href="#cmdoption-arrival_at_stop--transit" title="Permalink to this definition">¶</a></dt>
<dd><p>Directory (or .ZIP) with HRT details.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-arrival_at_stop--reject">
<tt class="descname">--reject</tt><tt class="descclassname"> no_stop.csv</tt><tt class="descclassname">, </tt><tt class="descname">-r</tt><tt class="descclassname"> no_stop.csv</tt><a class="headerlink" href="#cmdoption-arrival_at_stop--reject" title="Permalink to this definition">¶</a></dt>
<dd><p>Reject file to which Reports are written for which there is no stop.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-arrival_at_stop--stop">
<tt class="descname">--stop</tt><tt class="descclassname"> stop.csv</tt><tt class="descclassname">, </tt><tt class="descname">-s</tt><tt class="descclassname"> stop.csv</tt><a class="headerlink" href="#cmdoption-arrival_at_stop--stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Stops file to which Report, Stop, Stop Time, Route and Trip information
is written.</p>
</dd></dl>

</div></blockquote>
<p>Algorithm Components</p>
<blockquote>
<div><p>The core stop-finding algorithm is implemented via the <a class="reference internal" href="#caravel.arrival_at_stop.StopFinder" title="caravel.arrival_at_stop.StopFinder"><tt class="xref py py-class docutils literal"><span class="pre">StopFinder</span></tt></a>
class hierarchy.</p>
<p>The <a class="reference internal" href="#caravel.arrival_at_stop.arrival_at_stop" title="caravel.arrival_at_stop.arrival_at_stop"><tt class="xref py py-func docutils literal"><span class="pre">arrival_at_stop()</span></tt></a> process applies this algorithm, and writes
the successful results using a <a class="reference internal" href="#caravel.arrival_at_stop.WriteStop" title="caravel.arrival_at_stop.WriteStop"><tt class="xref py py-class docutils literal"><span class="pre">WriteStop</span></tt></a> instance.  The failures
are written using a <a class="reference internal" href="#caravel.arrival_at_stop.WriteNoStop" title="caravel.arrival_at_stop.WriteNoStop"><tt class="xref py py-class docutils literal"><span class="pre">WriteNoStop</span></tt></a> instance.</p>
<dl class="function">
<dt id="caravel.arrival_at_stop.arrival_at_stop">
<tt class="descclassname">caravel.arrival_at_stop.</tt><tt class="descname">arrival_at_stop</tt><big>(</big><em>reader</em>, <em>stop_finder</em>, <em>files</em>, <em>no_stop=&lt;built-in function print&gt;</em>, <em>stop=&lt;built-in function print&gt;</em><big>)</big><a class="reference internal" href="../_modules/caravel/arrival_at_stop.html#arrival_at_stop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.arrival_at_stop.arrival_at_stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Locate closest stop to the Report objects in the given file(s).
Create two outputs via callback functions.</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">no_stop</span></tt> is called with reports to which a stop could not be reliably assigned.
This function is called with four positional parameters.</p>
<dl class="function">
<dt id="caravel.arrival_at_stop.no_stop">
<tt class="descclassname">caravel.arrival_at_stop.</tt><tt class="descname">no_stop</tt><big>(</big><em>message</em>, <em>report</em>, <em>candidate_1</em>, <em>candidate_2</em><big>)</big><a class="headerlink" href="#caravel.arrival_at_stop.no_stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Callback function to write a report that could not be matched
reliably to a stop.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>message</strong> &#8211; Short string explanation</li>
<li><strong>report</strong> &#8211; <a class="reference internal" href="#caravel.report.Report" title="caravel.report.Report"><tt class="xref py py-class docutils literal"><span class="pre">caravel.report.Report</span></tt></a> object</li>
<li><strong>candidate_1</strong> &#8211; <a class="reference internal" href="#caravel.transit_system.Stop" title="caravel.transit_system.Stop"><tt class="xref py py-class docutils literal"><span class="pre">caravel.transit_system.Stop</span></tt></a> object or <tt class="docutils literal"><span class="pre">None</span></tt></li>
<li><strong>candidate_2</strong> &#8211; <a class="reference internal" href="#caravel.transit_system.Stop" title="caravel.transit_system.Stop"><tt class="xref py py-class docutils literal"><span class="pre">caravel.transit_system.Stop</span></tt></a> object or <tt class="docutils literal"><span class="pre">None</span></tt></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">stop</span></tt> is called with the reports to which a stop could be assigned.</p>
<dl class="function">
<dt id="caravel.arrival_at_stop.stop">
<tt class="descclassname">caravel.arrival_at_stop.</tt><tt class="descname">stop</tt><big>(</big><em>report</em>, <em>best_fit</em><big>)</big><a class="headerlink" href="#caravel.arrival_at_stop.stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Callback function to write a report was matched
reliably to a stop.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>report</strong> &#8211; <a class="reference internal" href="#caravel.report.Report" title="caravel.report.Report"><tt class="xref py py-class docutils literal"><span class="pre">caravel.report.Report</span></tt></a> object</li>
<li><strong>best_fit</strong> &#8211; <a class="reference internal" href="#caravel.transit_system.Candidate" title="caravel.transit_system.Candidate"><tt class="xref py py-class docutils literal"><span class="pre">caravel.transit_system.Candidate</span></tt></a> object</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>reader</strong> &#8211; An object of <a class="reference internal" href="#caravel.report.ReportReader" title="caravel.report.ReportReader"><tt class="xref py py-class docutils literal"><span class="pre">caravel.report.ReportReader</span></tt></a>.</li>
<li><strong>stop_finder</strong> &#8211; An  <a class="reference internal" href="#caravel.arrival_at_stop.StopFinder" title="caravel.arrival_at_stop.StopFinder"><tt class="xref py py-class docutils literal"><span class="pre">StopFinder</span></tt></a> instance.</li>
<li><strong>files</strong> &#8211; a sequence of report files.</li>
<li><strong>no_stop</strong> &#8211; an open file to which 4-tuples are written.</li>
<li><strong>stop</strong> &#8211; an open file to which 7-tuples are written.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">dictionary of counts</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="caravel.arrival_at_stop.InvalidReport">
<em class="property">class </em><tt class="descclassname">caravel.arrival_at_stop.</tt><tt class="descname">InvalidReport</tt><a class="headerlink" href="#caravel.arrival_at_stop.InvalidReport" title="Permalink to this definition">¶</a></dt>
<dd><p>The Report was either a Location or invalid in some other way
for locating a stop.</p>
</dd></dl>

<dl class="class">
<dt id="caravel.arrival_at_stop.NoStopFound">
<em class="property">class </em><tt class="descclassname">caravel.arrival_at_stop.</tt><tt class="descname">NoStopFound</tt><a class="headerlink" href="#caravel.arrival_at_stop.NoStopFound" title="Permalink to this definition">¶</a></dt>
<dd><p>No stop could be found.  The arguments include
a message, and up to two candidate stops.</p>
</dd></dl>

<dl class="class">
<dt id="caravel.arrival_at_stop.StopFinder">
<em class="property">class </em><tt class="descclassname">caravel.arrival_at_stop.</tt><tt class="descname">StopFinder</tt><big>(</big><em>connection</em><big>)</big><a class="headerlink" href="#caravel.arrival_at_stop.StopFinder" title="Permalink to this definition">¶</a></dt>
<dd><p>The Stop-Finder algorithm.</p>
<dl class="staticmethod">
<dt id="caravel.arrival_at_stop.StopFinder.heading">
<em class="property">static </em><tt class="descname">heading</tt><big>(</big><big>)</big><a class="headerlink" href="#caravel.arrival_at_stop.StopFinder.heading" title="Permalink to this definition">¶</a></dt>
<dd><p>Return headings which match the return value from <a class="reference internal" href="#caravel.arrival_at_stop.StopFinder.supplement" title="caravel.arrival_at_stop.StopFinder.supplement"><tt class="xref py py-meth docutils literal"><span class="pre">supplement()</span></tt></a>.</p>
</dd></dl>

<dl class="method">
<dt id="caravel.arrival_at_stop.StopFinder.process_report">
<tt class="descname">process_report</tt><big>(</big><em>report</em><big>)</big><a class="headerlink" href="#caravel.arrival_at_stop.StopFinder.process_report" title="Permalink to this definition">¶</a></dt>
<dd><p>Process a single Arrival or Dwell report.</p>
<ol class="arabic simple">
<li>Get services available for this date.</li>
<li>Get closest stops.</li>
<li>Get stops closest in time.</li>
<li>Add supplemental data.</li>
</ol>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>report</strong> &#8211; <a class="reference internal" href="#caravel.report.Report" title="caravel.report.Report"><tt class="xref py py-class docutils literal"><span class="pre">caravel.report.Report</span></tt></a> instance.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="caravel.arrival_at_stop.StopFinder.supplement">
<tt class="descname">supplement</tt><big>(</big><em>candidate</em><big>)</big><a class="headerlink" href="#caravel.arrival_at_stop.StopFinder.supplement" title="Permalink to this definition">¶</a></dt>
<dd><p>Fold in supplemental data.  The superclass does nothing extra.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>best_fit</strong> &#8211; a <a class="reference internal" href="#caravel.transit_system.Candidate" title="caravel.transit_system.Candidate"><tt class="xref py py-class docutils literal"><span class="pre">caravel.transit_system.Candidate</span></tt></a> instance.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">a new Best_Fit instance or possibly the unmodified candidate.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="caravel.arrival_at_stop.StopFinder_Route_Trip">
<em class="property">class </em><tt class="descclassname">caravel.arrival_at_stop.</tt><tt class="descname">StopFinder_Route_Trip</tt><big>(</big><em>connection</em><big>)</big><a class="headerlink" href="#caravel.arrival_at_stop.StopFinder_Route_Trip" title="Permalink to this definition">¶</a></dt>
<dd><p>The Stop-Finder algorithm.  This folds in route and trip
supplemental data.</p>
<dl class="class">
<dt id="caravel.arrival_at_stop.StopFinder_Route_Trip.Best_Fit">
<em class="property">class </em><tt class="descname">Best_Fit</tt><a class="headerlink" href="#caravel.arrival_at_stop.StopFinder_Route_Trip.Best_Fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Best_Fit(distance, time, stop, stop_time, route, trip)</p>
<dl class="attribute">
<dt id="caravel.arrival_at_stop.StopFinder_Route_Trip.Best_Fit.distance">
<tt class="descname">distance</tt><a class="headerlink" href="#caravel.arrival_at_stop.StopFinder_Route_Trip.Best_Fit.distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="attribute">
<dt id="caravel.arrival_at_stop.StopFinder_Route_Trip.Best_Fit.route">
<tt class="descname">route</tt><a class="headerlink" href="#caravel.arrival_at_stop.StopFinder_Route_Trip.Best_Fit.route" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="attribute">
<dt id="caravel.arrival_at_stop.StopFinder_Route_Trip.Best_Fit.stop">
<tt class="descname">stop</tt><a class="headerlink" href="#caravel.arrival_at_stop.StopFinder_Route_Trip.Best_Fit.stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="attribute">
<dt id="caravel.arrival_at_stop.StopFinder_Route_Trip.Best_Fit.stop_time">
<tt class="descname">stop_time</tt><a class="headerlink" href="#caravel.arrival_at_stop.StopFinder_Route_Trip.Best_Fit.stop_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="attribute">
<dt id="caravel.arrival_at_stop.StopFinder_Route_Trip.Best_Fit.time">
<tt class="descname">time</tt><a class="headerlink" href="#caravel.arrival_at_stop.StopFinder_Route_Trip.Best_Fit.time" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="attribute">
<dt id="caravel.arrival_at_stop.StopFinder_Route_Trip.Best_Fit.trip">
<tt class="descname">trip</tt><a class="headerlink" href="#caravel.arrival_at_stop.StopFinder_Route_Trip.Best_Fit.trip" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

</dd></dl>

<dl class="staticmethod">
<dt id="caravel.arrival_at_stop.StopFinder_Route_Trip.heading">
<em class="property">static </em><tt class="descclassname">StopFinder_Route_Trip.</tt><tt class="descname">heading</tt><big>(</big><big>)</big><a class="headerlink" href="#caravel.arrival_at_stop.StopFinder_Route_Trip.heading" title="Permalink to this definition">¶</a></dt>
<dd><p>Return headings which match the return value from <a class="reference internal" href="#caravel.arrival_at_stop.StopFinder_Route_Trip.supplement" title="caravel.arrival_at_stop.StopFinder_Route_Trip.supplement"><tt class="xref py py-meth docutils literal"><span class="pre">supplement()</span></tt></a>.</p>
</dd></dl>

<dl class="method">
<dt id="caravel.arrival_at_stop.StopFinder_Route_Trip.supplement">
<tt class="descclassname">StopFinder_Route_Trip.</tt><tt class="descname">supplement</tt><big>(</big><em>best_fit</em><big>)</big><a class="headerlink" href="#caravel.arrival_at_stop.StopFinder_Route_Trip.supplement" title="Permalink to this definition">¶</a></dt>
<dd><p>Fold in some extra data, the route and trip that apply to this stop.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>best_fit</strong> &#8211; <a class="reference internal" href="#caravel.transit_system.Candidate" title="caravel.transit_system.Candidate"><tt class="xref py py-class docutils literal"><span class="pre">caravel.transit_system.Candidate</span></tt></a> object</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">a <a class="reference internal" href="#caravel.arrival_at_stop.StopFinder_Route_Trip.Best_Fit" title="caravel.arrival_at_stop.StopFinder_Route_Trip.Best_Fit"><tt class="xref py py-class docutils literal"><span class="pre">StopFinder_Route_Trip.Best_Fit</span></tt></a> instance.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="caravel.arrival_at_stop.StopFinder_Next_Stop">
<em class="property">class </em><tt class="descclassname">caravel.arrival_at_stop.</tt><tt class="descname">StopFinder_Next_Stop</tt><big>(</big><em>connection</em><big>)</big><a class="headerlink" href="#caravel.arrival_at_stop.StopFinder_Next_Stop" title="Permalink to this definition">¶</a></dt>
<dd><p>The Stop-Finder algorithm.  This folds in route and next stop_time
supplemental data.</p>
<dl class="class">
<dt id="caravel.arrival_at_stop.StopFinder_Next_Stop.Best_Fit">
<em class="property">class </em><tt class="descname">Best_Fit</tt><a class="headerlink" href="#caravel.arrival_at_stop.StopFinder_Next_Stop.Best_Fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Best_Fit(distance, time, stop, stop_time, route, next)</p>
<dl class="attribute">
<dt id="caravel.arrival_at_stop.StopFinder_Next_Stop.Best_Fit.distance">
<tt class="descname">distance</tt><a class="headerlink" href="#caravel.arrival_at_stop.StopFinder_Next_Stop.Best_Fit.distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="attribute">
<dt id="caravel.arrival_at_stop.StopFinder_Next_Stop.Best_Fit.next">
<tt class="descname">next</tt><a class="headerlink" href="#caravel.arrival_at_stop.StopFinder_Next_Stop.Best_Fit.next" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="attribute">
<dt id="caravel.arrival_at_stop.StopFinder_Next_Stop.Best_Fit.route">
<tt class="descname">route</tt><a class="headerlink" href="#caravel.arrival_at_stop.StopFinder_Next_Stop.Best_Fit.route" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="attribute">
<dt id="caravel.arrival_at_stop.StopFinder_Next_Stop.Best_Fit.stop">
<tt class="descname">stop</tt><a class="headerlink" href="#caravel.arrival_at_stop.StopFinder_Next_Stop.Best_Fit.stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="attribute">
<dt id="caravel.arrival_at_stop.StopFinder_Next_Stop.Best_Fit.stop_time">
<tt class="descname">stop_time</tt><a class="headerlink" href="#caravel.arrival_at_stop.StopFinder_Next_Stop.Best_Fit.stop_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="attribute">
<dt id="caravel.arrival_at_stop.StopFinder_Next_Stop.Best_Fit.time">
<tt class="descname">time</tt><a class="headerlink" href="#caravel.arrival_at_stop.StopFinder_Next_Stop.Best_Fit.time" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

</dd></dl>

<dl class="staticmethod">
<dt id="caravel.arrival_at_stop.StopFinder_Next_Stop.heading">
<em class="property">static </em><tt class="descclassname">StopFinder_Next_Stop.</tt><tt class="descname">heading</tt><big>(</big><big>)</big><a class="headerlink" href="#caravel.arrival_at_stop.StopFinder_Next_Stop.heading" title="Permalink to this definition">¶</a></dt>
<dd><p>Return headings which match the return value from <a class="reference internal" href="#caravel.arrival_at_stop.StopFinder_Next_Stop.supplement" title="caravel.arrival_at_stop.StopFinder_Next_Stop.supplement"><tt class="xref py py-meth docutils literal"><span class="pre">supplement()</span></tt></a>.</p>
</dd></dl>

<dl class="method">
<dt id="caravel.arrival_at_stop.StopFinder_Next_Stop.supplement">
<tt class="descclassname">StopFinder_Next_Stop.</tt><tt class="descname">supplement</tt><big>(</big><em>best_fit</em><big>)</big><a class="headerlink" href="#caravel.arrival_at_stop.StopFinder_Next_Stop.supplement" title="Permalink to this definition">¶</a></dt>
<dd><p>Fold in some extra data, the next scheduled stop.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>best_fit</strong> &#8211; <a class="reference internal" href="#caravel.transit_system.Candidate" title="caravel.transit_system.Candidate"><tt class="xref py py-class docutils literal"><span class="pre">caravel.transit_system.Candidate</span></tt></a> object</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">a <a class="reference internal" href="#caravel.arrival_at_stop.StopFinder_Next_Stop.Best_Fit" title="caravel.arrival_at_stop.StopFinder_Next_Stop.Best_Fit"><tt class="xref py py-class docutils literal"><span class="pre">StopFinder_Next_Stop.Best_Fit</span></tt></a> instance.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div></blockquote>
<p>Output Components</p>
<blockquote>
<div><dl class="function">
<dt id="caravel.arrival_at_stop.prefix_fields">
<tt class="descclassname">caravel.arrival_at_stop.</tt><tt class="descname">prefix_fields</tt><big>(</big><em>prefix</em>, <em>nt_class</em><big>)</big><a class="reference internal" href="../_modules/caravel/arrival_at_stop.html#prefix_fields"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.arrival_at_stop.prefix_fields" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the list of field names from a namedtuple with a prefix.</p>
</dd></dl>

<dl class="function">
<dt id="caravel.arrival_at_stop.prefix_dict">
<tt class="descclassname">caravel.arrival_at_stop.</tt><tt class="descname">prefix_dict</tt><big>(</big><em>prefix</em>, <em>nt_obj</em><big>)</big><a class="reference internal" href="../_modules/caravel/arrival_at_stop.html#prefix_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.arrival_at_stop.prefix_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a dictionary from a namedtuple applying a prefix to the field names.</p>
</dd></dl>

<dl class="class">
<dt id="caravel.arrival_at_stop.WriteStop">
<em class="property">class </em><tt class="descclassname">caravel.arrival_at_stop.</tt><tt class="descname">WriteStop</tt><big>(</big><em>stop_finder</em>, <em>target=None</em><big>)</big><a class="headerlink" href="#caravel.arrival_at_stop.WriteStop" title="Permalink to this definition">¶</a></dt>
<dd><p>A callable writer for reports that have been matched to a stop.
This creates a CSV-format file attributes from
<a class="reference internal" href="#caravel.report.Report" title="caravel.report.Report"><tt class="xref py py-class docutils literal"><span class="pre">caravel.report.Report</span></tt></a>,
<a class="reference internal" href="#caravel.transit_system.Stop" title="caravel.transit_system.Stop"><tt class="xref py py-class docutils literal"><span class="pre">caravel.transit_system.Stop</span></tt></a>,
<a class="reference internal" href="#caravel.transit_system.Stop_Time" title="caravel.transit_system.Stop_Time"><tt class="xref py py-class docutils literal"><span class="pre">caravel.transit_system.Stop_Time</span></tt></a></p>
<p>How to create an object usable a callback with <a class="reference internal" href="#caravel.arrival_at_stop.arrival_at_stop" title="caravel.arrival_at_stop.arrival_at_stop"><tt class="xref py py-func docutils literal"><span class="pre">arrival_at_stop()</span></tt></a>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">with</span> <span class="nb">open</span><span class="p">(</span> <span class="n">args</span><span class="o">.</span><span class="n">stop</span><span class="p">,</span> <span class="s">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">stop_file</span><span class="p">:</span>
    <span class="n">stop</span><span class="o">=</span> <span class="n">Stop</span><span class="p">(</span> <span class="n">connection</span><span class="p">,</span> <span class="n">stop_file</span> <span class="p">)</span>
</pre></div>
</div>
<p>This creates a callable <tt class="docutils literal"><span class="pre">stop</span></tt> function that can be used like this</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">stop</span><span class="p">(</span> <span class="n">report</span><span class="p">,</span> <span class="n">candidate</span> <span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="caravel.arrival_at_stop.WriteStop.__call__">
<tt class="descname">__call__</tt><big>(</big><em>report</em>, <em>best_fit</em><big>)</big><a class="headerlink" href="#caravel.arrival_at_stop.WriteStop.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a row to the stop file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>report</strong> &#8211; <a class="reference internal" href="#caravel.report.Report" title="caravel.report.Report"><tt class="xref py py-class docutils literal"><span class="pre">caravel.report.Report</span></tt></a> object</li>
<li><strong>services</strong> &#8211; sevice id&#8217;s appropriate to the report</li>
<li><strong>best_fit</strong> &#8211; <a class="reference internal" href="#caravel.transit_system.Candidate" title="caravel.transit_system.Candidate"><tt class="xref py py-class docutils literal"><span class="pre">caravel.transit_system.Candidate</span></tt></a> object</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="caravel.arrival_at_stop.WriteStop.__init__">
<tt class="descname">__init__</tt><big>(</big><em>stop_finder</em>, <em>target=None</em><big>)</big><a class="headerlink" href="#caravel.arrival_at_stop.WriteStop.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the CSV writer around the target file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>stop_finder</strong> &#8211; <a class="reference internal" href="#caravel.arrival_at_stop.StopFinder" title="caravel.arrival_at_stop.StopFinder"><tt class="xref py py-class docutils literal"><span class="pre">StopFinder</span></tt></a> object.</li>
<li><strong>target</strong> &#8211; file-like object suitable to CSV writer.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="caravel.arrival_at_stop.WriteNoStop">
<em class="property">class </em><tt class="descclassname">caravel.arrival_at_stop.</tt><tt class="descname">WriteNoStop</tt><big>(</big><em>target=None</em><big>)</big><a class="headerlink" href="#caravel.arrival_at_stop.WriteNoStop" title="Permalink to this definition">¶</a></dt>
<dd><p>A callable writer for reports that have been matched to a stop.
This creates a CSV-format file attributes from
<a class="reference internal" href="#caravel.report.Report" title="caravel.report.Report"><tt class="xref py py-class docutils literal"><span class="pre">caravel.report.Report</span></tt></a>, and
<a class="reference internal" href="#caravel.transit_system.Stop" title="caravel.transit_system.Stop"><tt class="xref py py-class docutils literal"><span class="pre">caravel.transit_system.Stop</span></tt></a>.</p>
<p>How to create an object usable a callback with <a class="reference internal" href="#caravel.arrival_at_stop.arrival_at_stop" title="caravel.arrival_at_stop.arrival_at_stop"><tt class="xref py py-func docutils literal"><span class="pre">arrival_at_stop()</span></tt></a>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">with</span> <span class="nb">open</span><span class="p">(</span> <span class="n">args</span><span class="o">.</span><span class="n">reject</span><span class="p">,</span> <span class="s">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">no_stop_file</span><span class="p">:</span>
    <span class="n">no_stop</span><span class="o">=</span> <span class="n">NoStop</span><span class="p">(</span> <span class="n">no_stop_file</span> <span class="p">)</span>
</pre></div>
</div>
<p>This creates a callable <tt class="docutils literal"><span class="pre">no_stop</span></tt> function.</p>
<dl class="method">
<dt id="caravel.arrival_at_stop.WriteNoStop.__call__">
<tt class="descname">__call__</tt><big>(</big><em>status</em>, <em>report</em>, <em>dist_fit=None</em>, <em>time_fit=None</em><big>)</big><a class="headerlink" href="#caravel.arrival_at_stop.WriteNoStop.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a row to the no-stop file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>message</strong> &#8211; Short string explanation</li>
<li><strong>report</strong> &#8211; <a class="reference internal" href="#caravel.report.Report" title="caravel.report.Report"><tt class="xref py py-class docutils literal"><span class="pre">caravel.report.Report</span></tt></a> object</li>
<li><strong>candidate_1</strong> &#8211; <a class="reference internal" href="#caravel.transit_system.Stop" title="caravel.transit_system.Stop"><tt class="xref py py-class docutils literal"><span class="pre">caravel.transit_system.Stop</span></tt></a> object or <tt class="docutils literal"><span class="pre">None</span></tt></li>
<li><strong>candidate_2</strong> &#8211; <a class="reference internal" href="#caravel.transit_system.Stop" title="caravel.transit_system.Stop"><tt class="xref py py-class docutils literal"><span class="pre">caravel.transit_system.Stop</span></tt></a> object or <tt class="docutils literal"><span class="pre">None</span></tt></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="caravel.arrival_at_stop.WriteNoStop.__init__">
<tt class="descname">__init__</tt><big>(</big><em>target=None</em><big>)</big><a class="headerlink" href="#caravel.arrival_at_stop.WriteNoStop.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the CSV writer around the target file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>target</strong> &#8211; file-like object suitable to CSV writer.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="caravel.arrival_at_stop.get_args">
<tt class="descclassname">caravel.arrival_at_stop.</tt><tt class="descname">get_args</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/caravel/arrival_at_stop.html#get_args"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.arrival_at_stop.get_args" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse command-line arguments.
:returns: Arguments object.</p>
</dd></dl>

</div></blockquote>
</div>
<div class="section" id="module-caravel.stop_discovery">
<span id="stop-discovery"></span><h3>Stop Discovery<a class="headerlink" href="#module-caravel.stop_discovery" title="Permalink to this headline">¶</a></h3>
<p>Statistical route and stop discovery from location reports.</p>
<p>Synopsis</p>
<div class="highlight-python"><pre>python2.7 -m caravel.stop_discovery source...</pre>
</div>
<p>Description</p>
<blockquote>
<div>For each source file, filter the invalid Reports.  Summarize the
Arrival and Dwell reports.</div></blockquote>
<p>Options</p>
<blockquote>
<div><dl class="option">
<dt id="cmdoption-stop_discovery--debug">
<tt class="descname">--debug</tt><tt class="descclassname"></tt><tt class="descclassname">, </tt><tt class="descname">-d</tt><tt class="descclassname"></tt><a class="headerlink" href="#cmdoption-stop_discovery--debug" title="Permalink to this definition">¶</a></dt>
<dd><p>Set logging level.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-stop_discovery--format">
<tt class="descname">--format</tt><tt class="descclassname"> number</tt><a class="headerlink" href="#cmdoption-stop_discovery--format" title="Permalink to this definition">¶</a></dt>
<dd><p>Format number.  Generally maps to a subclass of <a class="reference internal" href="#caravel.report.ReportReader" title="caravel.report.ReportReader"><tt class="xref py py-class docutils literal"><span class="pre">caravel.report.ReportReader</span></tt></a>.</p>
</dd></dl>

<dl class="option">
<dt>
<tt class="descname">source...</tt></dt>
<dd><p>List of source files to process.</p>
</dd></dl>

</div></blockquote>
<p>Components</p>
<blockquote>
<div><dl class="function">
<dt id="caravel.stop_discovery.group_by_rte_dir_stop">
<tt class="descclassname">caravel.stop_discovery.</tt><tt class="descname">group_by_rte_dir_stop</tt><big>(</big><em>report_iter</em><big>)</big><a class="reference internal" href="../_modules/caravel/stop_discovery.html#group_by_rte_dir_stop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.stop_discovery.group_by_rte_dir_stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Accumulate stops from a sequence of Arrivals.</p>
<p>Generally, the report_iter is an instance of <a class="reference internal" href="#caravel.report.report_iter" title="caravel.report.report_iter"><tt class="xref py py-func docutils literal"><span class="pre">caravel.report.report_iter()</span></tt></a>.</p>
<p>It&#8217;s usually built like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">reader</span><span class="o">=</span> <span class="n">caravel</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">ReportReader_v1</span><span class="p">()</span>
<span class="n">rpt_iter</span><span class="o">=</span> <span class="n">caravel</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">report_iter</span><span class="p">(</span> <span class="n">reader</span><span class="p">,</span> <span class="p">[</span><span class="nb">list</span><span class="p">,</span><span class="n">of</span><span class="p">,</span><span class="n">files</span><span class="p">]</span> <span class="p">)</span>
</pre></div>
</div>
<p>This iterator will examine all the files in the list, extracting
all Report objects.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>report_iter</strong> &#8211; an iterator over <a class="reference internal" href="#caravel.report.Report" title="caravel.report.Report"><tt class="xref py py-class docutils literal"><span class="pre">caravel.report.Report</span></tt></a> instances.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">two values: (counts, route).  The counts is a dictinary of input, excluded, invalid
and arrivals actually processed.
The route is an OrderedDict, keyed by Route/Dir/Stop with sequence of arrival times.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="caravel.stop_discovery.display">
<tt class="descclassname">caravel.stop_discovery.</tt><tt class="descname">display</tt><big>(</big><em>route_dir</em><big>)</big><a class="reference internal" href="../_modules/caravel/stop_discovery.html#display"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.stop_discovery.display" title="Permalink to this definition">¶</a></dt>
<dd><p>Display the accumulated raw data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>route_dir</strong> &#8211; OrderedDict, keyed by Route/Dir/Stop with sequence of arrival times.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="caravel.stop_discovery.get_args">
<tt class="descclassname">caravel.stop_discovery.</tt><tt class="descname">get_args</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/caravel/stop_discovery.html#get_args"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#caravel.stop_discovery.get_args" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse command-line arguments.
:returns: Arguments object.</p>
</dd></dl>

</div></blockquote>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../caravel.html">
              <img class="logo" src="../_static/Caravel2_(PSF).png" alt="Logo"/>
            </a></p>
  <h3><a href="../caravel.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Implementation</a><ul>
<li><a class="reference internal" href="#low-level-structures">Low-Level Structures</a><ul>
<li><a class="reference internal" href="#module-caravel.acquire">Acquire</a></li>
<li><a class="reference internal" href="#module-caravel.report">Report</a><ul>
<li><a class="reference internal" href="#report-objects">Report Objects</a></li>
<li><a class="reference internal" href="#report-factory">Report Factory</a></li>
<li><a class="reference internal" href="#json-codec">JSON Codec</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-caravel.transit_system">Transit System</a><ul>
<li><a class="reference internal" href="#transit-objects">Transit Objects</a></li>
<li><a class="reference internal" href="#transit-connection">Transit &#8220;Connection&#8221;</a></li>
<li><a class="reference internal" href="#query-functions">Query Functions</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#analysis-and-profiling">Analysis and Profiling</a><ul>
<li><a class="reference internal" href="#module-caravel.statistics">Statistics</a></li>
<li><a class="reference internal" href="#module-caravel.arrival_stats">Arrival Statistics</a></li>
<li><a class="reference internal" href="#module-caravel.transit_stats">Transit System Statistics</a></li>
</ul>
</li>
<li><a class="reference internal" href="#applications">Applications</a><ul>
<li><a class="reference internal" href="#module-caravel.split">Split</a></li>
<li><a class="reference internal" href="#module-caravel.arrival_at_stop">Arrival At Stop</a></li>
<li><a class="reference internal" href="#module-caravel.stop_discovery">Stop Discovery</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../design/route_details.html"
                        title="previous chapter">Route Discovery</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/implementation/index.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../design/route_details.html" title="Route Discovery"
             >previous</a> |</li>
        <li><a href="../caravel.html">Caravel-Transit 1.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, S.Lott.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.2.
    </div>
  </body>
</html>